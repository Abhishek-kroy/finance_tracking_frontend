{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Pie}from'react-chartjs-2';import{Chart as ChartJS,ArcElement,Tooltip,Legend}from'chart.js';import axios from'axios';import{useNavigate}from'react-router-dom';// Register the required elements for Chart.js\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";ChartJS.register(ArcElement,Tooltip,Legend);const SpendingDistribution=()=>{const[error,setError]=useState('');const[budgets,setBudgets]=useState([]);const[chartData,setChartData]=useState(null);// Initialize as null\nconst navigate=useNavigate();useEffect(()=>{const fetchBudgets=async()=>{try{var _response$data;let token=localStorage.getItem(\"token\");if(!token){setError(\"Unauthorized! Please log in again.\");navigate(\"/login\");return;}const response=await axios.get('https://finance-tracker-backend-0h5z.onrender.com/api/v1/budgets/current-month',{headers:{Authorization:\"Bearer \".concat(token)}});const budgetData=((_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.budgets)||[];// Ensure budgets exist\nsetBudgets(budgetData);}catch(error){var _error$response,_error$response$data;console.error('Error fetching budgets:',error);setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Failed to load budgets.\");}};fetchBudgets();},[navigate]);useEffect(()=>{// Prepare data for the Pie chart\nif(budgets.length>0){const labels=budgets.map(budget=>budget.name||'Unnamed');// Default label if missing\nconst data=budgets.map(budget=>budget.spentAmount||0);// Default to 0 if undefined\nconst colors=['#FF6384','#36A2EB','#FFCE56','#4BC0C0','#FF5733','#C70039','#900C3F'];// Dynamic colors if more categories\nsetChartData({labels:labels,datasets:[{data:data,backgroundColor:colors.slice(0,labels.length)// Ensure colors match the number of categories\n}]});}else{setChartData(null);// Handle case with no budgets\n}},[budgets]);return/*#__PURE__*/_jsxs(\"div\",{className:\"chart-container w-full\",children:[error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500\",children:error}),chartData?/*#__PURE__*/_jsx(Pie,{data:chartData}):/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No data available for the current month.\"})]});};export default SpendingDistribution;","map":{"version":3,"names":["React","useState","useEffect","Pie","Chart","ChartJS","ArcElement","Tooltip","Legend","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","register","SpendingDistribution","error","setError","budgets","setBudgets","chartData","setChartData","navigate","fetchBudgets","_response$data","token","localStorage","getItem","response","get","headers","Authorization","concat","budgetData","data","_error$response","_error$response$data","console","message","length","labels","map","budget","name","spentAmount","colors","datasets","backgroundColor","slice","className","children"],"sources":["C:/Users/Abhishek Kumar Roy/OneDrive/Desktop/finance_tracker/finance_tracker/src/components/SpendingDistribution.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Pie } from 'react-chartjs-2';\r\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\n// Register the required elements for Chart.js\r\nChartJS.register(ArcElement, Tooltip, Legend);\r\n\r\nconst SpendingDistribution = () => {\r\n    const [error, setError] = useState('');\r\n    const [budgets, setBudgets] = useState([]);\r\n    const [chartData, setChartData] = useState(null); // Initialize as null\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        const fetchBudgets = async () => {\r\n            try {\r\n                let token = localStorage.getItem(\"token\");\r\n                if (!token) {\r\n                    setError(\"Unauthorized! Please log in again.\");\r\n                    navigate(\"/login\");\r\n                    return;\r\n                }\r\n\r\n                const response = await axios.get('https://finance-tracker-backend-0h5z.onrender.com/api/v1/budgets/current-month', {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                });\r\n\r\n                const budgetData = response.data?.budgets || []; // Ensure budgets exist\r\n                setBudgets(budgetData);\r\n\r\n            } catch (error) {\r\n                console.error('Error fetching budgets:', error);\r\n                setError(error.response?.data?.message || \"Failed to load budgets.\");\r\n            }\r\n        };\r\n\r\n        fetchBudgets();\r\n    }, [navigate]);\r\n\r\n    useEffect(() => {\r\n        // Prepare data for the Pie chart\r\n        if (budgets.length > 0) {\r\n            const labels = budgets.map(budget => budget.name || 'Unnamed'); // Default label if missing\r\n            const data = budgets.map(budget => budget.spentAmount || 0); // Default to 0 if undefined\r\n            const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#FF5733', '#C70039', '#900C3F']; // Dynamic colors if more categories\r\n\r\n            setChartData({\r\n                labels: labels,\r\n                datasets: [{\r\n                    data: data,\r\n                    backgroundColor: colors.slice(0, labels.length), // Ensure colors match the number of categories\r\n                }],\r\n            });\r\n        } else {\r\n            setChartData(null); // Handle case with no budgets\r\n        }\r\n    }, [budgets]);\r\n\r\n    return (\r\n        <div className=\"chart-container w-full\">\r\n            {error && <p className=\"text-red-500\">{error}</p>}\r\n            {chartData ? (\r\n                <Pie data={chartData} />\r\n            ) : (\r\n                <p className=\"text-gray-500\">No data available for the current month.</p>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SpendingDistribution;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}